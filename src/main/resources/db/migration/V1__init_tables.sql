CREATE TABLE _user (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    full_name VARCHAR(255) NOT NULL,
    username VARCHAR(255) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    role VARCHAR(50) NOT NULL
);

CREATE TABLE account (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    account_number VARCHAR(16) NOT NULL UNIQUE CHECK (account_number ~ '^[0-9]{16}$'),
    balance DECIMAL(10, 2) NOT NULL,
    user_id BIGINT NOT NULL REFERENCES _user(id) ON DELETE CASCADE
);

CREATE TABLE transaction (
     id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
     from_account_id BIGINT NOT NULL REFERENCES account(id) ON DELETE CASCADE,
     to_account_id BIGINT NOT NULL REFERENCES account(id) ON DELETE CASCADE,
     amount DECIMAL(10, 2) NOT NULL CHECK (amount > 0)
);